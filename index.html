<!doctype html>
<html lang="zh-Hans" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href='https://fonts.googleapis.com/css?family=Droid+Serif|Open+Sans:400,700' rel='stylesheet' type='text/css'>
	<link rel="icon" href="img/favicon.ico?" type="image/x-icon">

	<link rel="stylesheet" href="css/reset.css"> <!-- CSS reset -->
	<link rel="stylesheet" href="css/style.css"> <!-- Resource style -->
  	
	<title>Love ‚ô•Ô∏è Timeline</title>
</head>
<body>
	<header>
		<br>
		<h1>Love Timeline</h1>
		<h2 id="days"></h2>
	</header>
	<div class="out-container">
		<section id="cd-timeline" class="cd-container">
		</section> <!-- cd-timeline -->
	</div>

	<footer>
		<br>
		<h1>Final Words</h1>
		<h2>I can't sing, I can't play the piano, and I can't write poetry. What I'm good at is just writing some not-so-brilliant code and making some not-so-exceptional designs.</h2>
		<h2>Honestly, I‚Äôm not sure if you would like receiving a Valentine‚Äôs Day gift that doesn‚Äôt physically exist.</h2>
		<h2>All I can do is pour my love for you into every keystroke, write this simple webpage, and hope that you will like it.</h2>
		<h2>Mengmeng, I love you. Happy Valentine's Day 2016.</h2>
		<br>
		<h3>Written by @hkalexling with ‚ù§Ô∏é. Open source on <a target="_blank" href="https://github.com/hkalexling/Love-Timeline"><u>GitHub</u></a></h3>
	</footer>

	<!-- Question Form -->
	<div class="question-container">
		<h2>Answer These Questions ‚ù§Ô∏è</h2>
		<form id="loveForm">
			<label for="q1">What do you love most about us?</label><br>
			<input type="text" id="q1" required><br><br>

			<label for="q2">Your favorite memory with me?</label><br>
			<input type="text" id="q2" required><br><br>

			<label for="q3">One thing you look forward to in our future?</label><br>
			<input type="text" id="q3" required><br><br>

			<button type="submit">Submit üíñ</button>
		</form>
		<p id="responseMessage"></p>
	</div>

	<!-- Display Responses -->
	<h2>Previous Answers</h2>
	<ul id="responsesList"></ul>

	<!-- Firebase SDK -->
	<script type="module">
		// Import Firebase modules
		import { initializeApp } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js";
		import { getDatabase, ref, push, set, onValue } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js";

		// Firebase Configuration
		const firebaseConfig = {
			apiKey: "AIzaSyDPjELFkrg7xenCfaSV4dYn-347j4-ORDk",
			authDomain: "project-10bfb.firebaseapp.com",
			databaseURL: "https://project-10bfb-default-rtdb.firebaseio.com",
			projectId: "project-10bfb",
			storageBucket: "project-10bfb.firebasestorage.app",
			messagingSenderId: "952863522805",
			appId: "1:952863522805:web:f08e94725567251aa2aabc",
			measurementId: "G-W51R62V1LP"
		};

		// Initialize Firebase
		const app = initializeApp(firebaseConfig);
		const database = getDatabase(app);

		// Handle Form Submission
		document.getElementById("loveForm").addEventListener("submit", function(event) {
			event.preventDefault();

			// Get user input
			let answer1 = document.getElementById("q1").value;
			let answer2 = document.getElementById("q2").value;
			let answer3 = document.getElementById("q3").value;
			let timestamp = new Date().toISOString();

			// Reference to Firebase Realtime Database
			const responsesRef = ref(database, "responses");
			const newResponseRef = push(responsesRef);

			// Store responses
			set(newResponseRef, {
				loveMost: answer1,
				favoriteMemory: answer2,
				futurePlan: answer3,
				submittedAt: timestamp
			})
			.then(() => {
				document.getElementById("responseMessage").innerHTML = "<br><strong>Thank you, my love! üíñ</strong><br>Your responses have been saved! üòä";
				document.getElementById("loveForm").reset();
			})
			.catch(error => {
				console.error("Error saving response: ", error);
				alert("Something went wrong. Please try again.");
			});
		});

		// Display Responses in Real-time
		const responsesRef = ref(database, "responses");
		onValue(responsesRef, (snapshot) => {
			let list = document.getElementById("responsesList");
			list.innerHTML = "";

			snapshot.forEach((childSnapshot) => {
				let data = childSnapshot.val();
				let listItem = document.createElement("li");
				listItem.innerHTML = `<strong>${data.submittedAt}</strong><br>‚ù§Ô∏è ${data.loveMost}<br>üì∏ ${data.favoriteMemory}<br>‚ú® ${data.futurePlan}<br><br>`;
				list.appendChild(listItem);
			});
		});
	</script>

	<script src="js/modernizr.js"></script> <!-- Modernizr -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	<script src="js/main.js"></script> <!-- Resource jQuery -->
</body>
</html>
